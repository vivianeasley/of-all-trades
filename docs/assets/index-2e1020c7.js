(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const F=["#242424","#005555","#008888","#55bbbb","#cccccc","#cc9999","#bb5555","#aa0000","#770077","#aa00aa","#cc22cc","#cc88aa","#cccc88","#55cc55","#00aa00","#008800"];function de(){const e=[];for(let n=0;n<F.length;n++){const a=t(F[n]);e.push(a)}return e;function t(n){var a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;n=n.replace(a,function(o,u,l,c){return u+u+l+l+c+c});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return r?[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)]:null}}function ue(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function fe(e,t){return new Promise(n=>{var a=Number.POSITIVE_INFINITY,r;let o=0;e.forEach((u,l)=>{r=ue(t,u),r<a&&(a=r,o=l)}),n(F[o])})}async function he(e,t){const n=de(),a=document.querySelector("#start"),r=document.querySelector("#final"),o=a.getContext("2d",{willReadFrequently:!0}),u=r.getContext("2d"),l=[],c=t?100:36,i=t?100:44;if(a.width=c,a.height=i,r.width=c,r.height=i,t)o.font="800px Arial",o.fillText(e[0],-150,20);else{o.fillStyle="#000",o.fillRect(0,0,c,i),o.font="30px Arial";for(let m=0;m<e.length;m++)o.fillText(e[m],2,40)}let s=0,d=0;for(;s<=c&&d<i;){const m=o.getImageData(s,d,1,1).data;l[d]||(l[d]=[]),l[d].push([m[0],m[1],m[2]]),s++,s>c&&(s=0,d++)}for(let m=0;m<l.length;m++)for(let p=0;p<l[m].length;p++){const M=await fe(n,l[m][p]);u.fillStyle=l[m][p].join(", ")==="0, 0, 0"?"#00000000":M,u.fillRect(p,m,1,1)}return r.toDataURL("image/png")}const me=e=>{const t={},n=["▮","▬","▰","▲","▴","▶","▸","►","▼","▾","◀","◂","◄","◆","◖","◗","◢","◣","◤","◥","◼"],a=e.getContext("2d",{willReadFrequently:!0});t.generate=async()=>{const o=[];e.width=200,e.height=200,a.filter="blur(5px)",a.font="16px Arial";let c=0;for(;c<200;){const d=n[Math.floor(Math.random()*n.length)];a.fillText(d,Math.random()*200,Math.random()*200),c++}let i=0,s=0;for(;i<=200&&s<200;){const d=await r(i,s);o[s]||(o[s]=[]),o[s].push(d[3]),i++,i>200&&(i=0,s++)}return o};function r(o,u){return new Promise(l=>{l(a.getImageData(o,u,1,1).data)})}return t},ge=["You approach a circle of standing stones. Remenants of druidic rituals can be seen. You leave immeditaly.","You come across a pile of chopped wood. The wood has sat out for a season. You wonder why a woodcuter would have left this here to rot.","You find a lone fountain. Why would someone build this here you think to yourself. You take a sip of the clear inviting water. You feel changed.","You pass an acient oak. Something strikes you about this tree. You feel like if you close your eyes you can almost hear it signing a song.","You find a dusty scroll hidden under a rock outcropping. The language is foriegn to you. You keep the scroll for kidnling.","Floating across the ground you see an orb of pulsating light. A willow-of-the-whisp you excalim! You run terrified.","A key sits half buried in the dirt. Someone somewhere is missing this key. You take it for the iron.","You find a candle stuck to a rock. This looks to have been part of some ritual. The area gives you an unsettled feeling. You leave quietly.","You see a rainbow. So beautiful.","You see a while flower. It's beauty captures you and you stop to smell it. It smells sweet and satisfying.","As you come upon a large toadstool for a brief moment you were sure you saw a small human figure sitting upon it. Whatever was there is gone now.","You find a shell. You lift it to your ear and hear the ocean. What witchcraft is this!!!!","You see a skull peaking out of th earth. The skull is ancient. You say a prayer and continue on your way.","A glint catches your eye. Upon further inspection you find that it is a clear rock. You huck it at a tree and continue your travels.","The sound of a bell starts gently ringing. It grows closer. You hide. The sound passes close and then fades off into the distance. You saw nothing.","You come a upon an old woman who offers to tell you your future. She says you will never satisfy your insatiable hunger for knowledge unless you can find the ship made of iron.","A giant stone head sits out in the open. Scratched in the back is a map that seems to show a city out in the ocean and creatures half human and half fish.","You come across a lemon tree. Not today scurvy!"],L=["affectionate","afraid","aggressive","altruistic","amiable","angry","animated","annoyed","anxious","appreciative","argumentative","arrogant","attentive","awkward","bashful","bewildered","bold","bored","bossy","brave","brilliant","calm","capable","carefree","careful","caring","cautious","charismatic","charming","cheerful","childish","clever","clumsy","coarse","cold-hearted","compassionate","concerned","confident","confused","conscientious","considerate","cooperative","courageous","cowardly","creative","curious","dainty","daring","decisive","demanding","dependable","determined","devoted","dignified","diligent","discouraged","dishonest","domineering","doubtful","dreamer","eager","easygoing","efficient","encouraging","energetic","enthusiastic","exuberant","fair","fanciful","fearless","finicky","flexible","focused","forgiving","frank","friendly","frugal","frustrated","fun-loving","funny","generous","gentle","giving","gloomy","grateful","greedy","gregarious","gullible","happy","hard-working","hardy","harried","helpful","hesitant","honest","hospitable","humble","impatient","impulsive","independent","industrious","innocent","innovative","inquisitive","insistent","intelligent","intrepid","inventive","jovial","kind","lazy","light-hearted","logical","lonely","lovable","loving","malicious","meek","messy","meticulous","mischievous","moody","mysterious","naive","negligent","nervous","obliging","observant","obstinate","optimistic","organized","patient","pensive","persevering","persuasive","pessimistic","picky","pleasant","pompous","popular","positive","precise","puzzled","quarrelsome","quiet","quixotic","resourceful","sarcastic","scheming","scornful","secretive","self-reliant","sense of humor","sensitive","serious","shrewd","simple","sincere","skillful","slovenly","smart","sneaky","sociable","strange","strict","stubborn","sullen","superstitious","supportive","surly","suspicious","sweet","taciturn","talented","talkative","tenacious","tense","thankful","thorough","thoughtful","thrifty","timid","tireless","tolerant","touchy","trusting","trustworthy","truthful","unscrupulous","unselfish","upset","valiant","versatile","visionary","warm","warm-hearted","whimsical","wise","witty","unkempt","deliberative","reckless","disciplined","inefficient","envisions the unseen","fatigued","unfocused","addled","poor health","imaginative","unimaginative","innovative","knowledgeable","ignorant","observant","erratic","responsible","irresponsible","risk-taker","averse to risk","stressed","disorganized","disorderly","trustworthy","untrustworthy","careless","clumsy","lack of verbal skills","Gruff","Insecure","Conceited","Speaks in rhymes","Competitive"],pe=["Accidents","Wild animals","Bathing","Bats","Bogeyman","Crossing bridges","Bulls","Beggars","Burglars","Being buried alive","Cemeteries","Childbirth","Choking","Clouds","Confined spaces","Corpses","Crowded public places","Mobs","Crystals","death","Decaying matter","Defeat","Demons","Disease","Dogs","Dreams","Dying","Fever","Fire","Flogging","Floods","Forests","Fur (skin of animals)","Ghosts","Heat","Heights","Hell","Heredity","Holy things","Horses","Ice","Insanity","Insects","Injury","Jumping from high places","Knowledge","Lice","Lightening and thunder","Loud noises","Meteors","Mice","Mirrors","Moths","Moon","Myths","Night","Open spaces","Operations","Pain","Parasites","Pointed objects","Poison","Poverty","Priests","Puppets","Rabies","Rats","Religion","Returning home","Responsibility","Ridicule","Riding in a wagon or cart","Rivers","Road travel","Robbers","Shadows","Skin lesions","Sleep","Steep slopes","Smothering","Snakes","Snow","Spiders","Spirits","Stars","Stings","Strangers","Tapeworms","Time","Toads","Tyrants","Virgins","Washing","Wind","Witches and witchcraft","Work","Worms"],U=["Ursula","Vera","Abigail","Antonia","Amelia","Ada","Adelaide","Adela","Adeline","Adriana","Agatha","Ailith","Alana","Alberta","Albina","Alexandra","Alexis","Allegra","Angelica","Altabella","Ama","Antonia","Annora","Ava","Beatrice","Cecilia","Eira","Ella","Eleanor","Elisaria","Euphemia","Genevieve","Gunnora","Heloise","Honora","Helen","Joan","Matilda","Mirabel","Nezetta","Nadalinde","Olive","Osanna","Petra","Philomena","Phoebe","Portia","Regina","Sabina","Serena","Sibyl","Sophia","Stella","Thora","Ursula","Vera","Winifred","Zelda"],Z=["Abraham","Absalom","Abelard","Acfrid","Achard","Adam","Adelo","Aderich","Ailbern","Adrewic","Adrian","Alaric","Albin","Alexander","Alfwin","Aldebrand","Ambrose","Alamand","Alard","Alaric","Alf","Alwin","Anthony","Archibald","Arthur","Aldo","Alphonse","Abelard","Benedict","Bartholomew","Bertram","Crispin","Daegal","Drustan","Edmund","Elric","Emil","Florian","Gandalf","Godfrey","Gregory","Grimwald","Hamlin","Hawk","Hildebald","Kenric","Leif","Lothar","Morcant","Oliver","Orvyn","Richard","Randolf","Roland","Torsten","Wilkin","Balthasar"],R=["Gervaise","Wainwright","Heathcliff","Albrecht","Hildebrand","Devereaux","Heinrich","Tudor","Templeton","Braxton","Jacobo","Mannix","Benedict","Beckett","Wesley","Maynard","Kimball","Otto","Bassett","Wallace","Oakes","Lister","Tobias","Conrad","Jasper","Bayard","Burne","Hyde","Walden","Gilbert","Fleming","Mann","Rowe","Hammond","Ballard","Kirby","Aiken","Beasley","Frost","Giles","Felix","Harding","Dudley","Barlow","Lange","Pierson","Denton","Courtney","Brandon","Weston","Daley","Elias","Larkin","Godwin","Boswell","Jarrett","Lovell","Roland","Moreland","Lorenzo","Aldrich","Ambrose","Bartley","Thayer","Fenton","Dietrich","Borden","Bartholomew","Garvin","Cecil","Lyman","Brant","Charlton","Seward","Easton","Nilson","Andre","Dayton","Archibald","Ralph","Leo","Aston","Berkeley","Carleton","Kipling","Sherwin","Alton","Bradburn","Osmond","Chilton","Mendel","Birney","Rawlins","Edison","Lyndon","Marden","Atherton","Amaury","Aramis","Brawley","Geoffrey","Haynes","Hill","Hughes","Kimball","Klein","Koch","Kruger","Maddock","Norman","Nuemann","Payne","Schafer","Schneider","Taylor","Turner","Wood","Beckett","Brewer","Browne","Carey","Ead","Aaberg","Adalbert","Albrecht","Alwyn","Annora","Arvel","Ashdown","Audovera","Badden","Bartholomew","Burchard","Cosimo","Enegram","Frithswith","Grimald","Hankin","Hilith","Isolda","Kaiser","Louthy","MacQuoid","Mannering","Merek","Nesta","Olbrecht","Pernelle","Pythias","Rainilda","Rolfe","Sallow","Squire","Terrowin","Theano","Tonis"],ye=["red","white","curly","blonde"],ne=[["Peddler","Hunter","Trapper"],["Woodcutter","Shepherd","Farmer"],["miner","Tanner","Ropemaker","Brewer","Explorer","Healer"],["Fisherman","Cook","Shipwright","Merchant","Sailor","Blacksmith","Carpenter","Cartographer"],["Lord","Tailor","Confectioner","Leatherworker","Banker","Weaver"]],J={visualFeature:["Heterochromia","Goiter","Rickets","Missing fingers","Birthmark","Beautiful","Burn mark","Freckles","Short","Tall","Frail","Stout","Dimples","Scars","Unkempt","Callouses"]},N={motivation:["Survival","Love","Honor","Control","Save","Serve","Rule","Destroy","Grief","Betrayal","Fear","Escape","Revenge","Recover","Justice","Desire","Discover","Achieve","Hate","Ambition"],traitMain:L,trait:L,traitLesser:L,fear:pe};let b={};async function W(){b={};const e=Math.random(),t=g(1,10)+g(1,10)+g(1,10)+g(1,10),n=await re(ye);return b.name=await be(e),b.age=t,b.hair=n,Ae(),ve(),b.imageId=we(t,e,n),b}function we(e,t,n){if(e<=5)return 9;if(e<=11)return 10;if(e>60&&t<.3)return 16;if(e>60&&t>.7)return 21;if(e>60)return 11;if(t<.3)return a(17,n);if(t>.7)return a(22,n);return a(12,n);function a(r,o){if(o==="curly")return r;if(o==="red")return r+1;if(o==="white")return r+2;if(o==="blonde")return r+3}}function ae(e,t,n){let a="";for(const o in e)o==="name"?a+=`<details closed><summary>${e[o]} - ${t}</summary>`:o==="imageId"?a+=`<div><img src="${n[e.imageId]}"></div>`:a+=`<div>${ke(o)}: <span class="bold">${e[o]}</span></div>`;a+="</details>";const r=document.createElement("span");return r.innerHTML=a,r}function be(e){return new Promise(t=>{const n=R[Math.floor(Math.random()*R.length)];e<=.5?t(`${U[Math.floor(Math.random()*U.length)]} ${n}`):t(`${Z[Math.floor(Math.random()*Z.length)]} ${n}`)})}function ve(){for(const e in N)b[e]=N[e][Math.floor(Math.random()*N[e].length)];return b}async function Ae(){for(const e in J)b[e]=await re(J[e]);return b}function re(e){return new Promise(t=>{const n=[...e,...e.reverse()],a=Math.ceil(n.length/2),r=g(0,a)+g(0,a);t(n[r]?n[r]:n[n.length-1])})}function g(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}function ke(e){const t=e.replace(/([a-z])([A-Z])/g,"$1 $2").split(" ");let n="";return t.forEach(a=>{n=n+a.charAt(0).toUpperCase()+a.slice(1)+" "}),n}const Me=["Chicken says cluck","Pig says oink","Cow says mooo","Sheep says baaa","Dog barks","Goat gives a funny look and screams","Horse whinnys"],Ie=["Deer says EEuurrruu","Owl says hooo","Rat says squeak","Bat says chirp","Rabbit runs off and hides in the underbrush","Wild dog yaps and barks"],S=document.querySelector("#story"),X=document.querySelector("#game"),y=[8,8],h=[100,100];let H;const Q=["🧕","🌲","🌳","🛖","🏚️","⛪","🏛️","🏯","🏰","👶","🧒","🧓","🧑‍🦱","🧑‍🦰","🧑‍🦳","🧑","👵","👩‍🦱","👩‍🦰","👩‍🦳","👱‍♀️","👴","👨‍🦱","👨‍🦰","👨‍🦳","🧔","🐓","🐖","🐂","🐏","🐕","🐐","🐎","🦌","🦉","🐀","🦇","🐇","🐕","🪨","🪵","⛲","🌳","📜","✨","🗝️","🕯️","🌈","🌺","🍄","🐚","💀","💎","🔔","🔮","🗿","🍋","🧜‍♂️","🛸"],v=[];let w=0;const k=ne.flat();for(let e=0;e<k.length;e++){const t=document.createElement("li");t.textContent=k[e]+" - not apprenticed",document.querySelector("ol").appendChild(t)}const C=xe(),Se=document.querySelector("#perlin"),V=me(Se);let q,oe;const Ce={water:"#00445a",plains:"#359135",forest:"#005a00",mountain:"grey",snow:"#f1f1f1"},_={n:()=>A(-1,-1),e:()=>A(-1,1),w:()=>A(1,-1),s:()=>A(1,1),nw:()=>A(0,-1),sw:()=>A(1,0),se:()=>A(0,1),ne:()=>A(-1,0)};document.querySelector("#ui").addEventListener("click",e=>{_[e.target.dataset.d]&&_[e.target.dataset.d]()},!0);const x=()=>{var e,t;return(t=(e=C[y[1]])==null?void 0:e[y[0]])==null?void 0:t.data};function A(e,t){const n=x(),a=["forest","plains"];w<17&&a.push("water"),h[1]>=199&&u(0,1),h[1]<=0&&u(0,-1),h[0]>=199&&u(1,0),h[0]<=0&&u(-1,0);const r=se(n[h[1]+t][h[0]+e].elevation);if(r==="mountain"&&w<8){S.textContent="You need to have apprenticed with a ropemaker to ascend mountains.";return}if(r==="water"&&w<17){S.textContent="You need to have apprenticed with a shipwright to sail across the ocean.";return}if(r==="snow"&&w<24){S.textContent="You need to have apprenticed with a tailor to travel in snowy peaks.";return}h[0]=h[0]+e,h[1]=h[1]+t;const o=n[h[1]][h[0]].person;if(k[w]&&(o==null?void 0:o.profession)===k[w]){const l=document.querySelectorAll("ol > li"),c=ae(o.data,o.profession,v);l[w].textContent="",l[w].appendChild(c),Re(3+w),w++}G();async function u(l,c){var s,d;if(!((s=C[y[1]+c])!=null&&s[y[0]+l])){S.textContent("You've reached the edge of this land. You can travel no further in this direction.");return}if(c!==0&&(y[1]=y[1]+c,h[1]>=199?h[1]=0:h[1]=199),l!==0&&(y[0]=y[0]+l,h[0]>=199?h[0]=0:h[0]=199),typeof((d=C[y[1]])==null?void 0:d[y[0]])[0]=="number")ie();else{const f=await O(h[0],h[1],a);h[0]=f[0],h[1]=f[1],G()}}}setTimeout(async()=>{await Pe(),ie()},1e3);async function ie(){q=[...C[y[1]][y[0]]],oe=await V.generate();const e=await V.generate();C[y[1]][y[0]]={name:R[y[1]+y[0]],locs:[],data:e},await Te();const t=await O(h[0],h[1],["forest","plains"]);h[0]=t[0],h[1]=t[1],await Be(),G()}function O(e,t,n){return new Promise(a=>{const r=x();let o=1,u=0;const l=[[-1,1],[1,-1],[1,1],[-1,-1],[0,1],[-1,0],[0,-1],[1,0]];for(;o<49;){l[u]||(u=0);const c=t+o*l[u][0],i=e+o*l[u][1],s=r[c]?r[c][i]:void 0;s&&n.includes(s.biome)&&a([i,c]),o++,u++}})}function xe(){let e=0,t=0;const n=[];for(let a=0;a<15;a++){n.push([]);for(let r=0;r<15;r++){n[a].push([]);const o=Math.random();e<1&&a>1&&o>.95&&(H=[r,a],n[a][r].push(5),e++),t<5&&o>.7&&(n[a][r].push(4),t++),Math.random()>.5&&n[a][r].push(3);for(let u=0;u<10;u++)Math.random()>.7&&n[a][r].push(2),Math.random()>.6&&n[a][r].push(1)}}return e===0&&(H=[0,0],n[0][0].push(5),e++),n}function se(e){if(e<20)return"water";if(e>=20&&e<88)return"plains";if(e>=88&&e<158)return"forest";if(e>=158&&e<200)return"mountain";if(e>=200)return"snow"}async function Te(){const e=x();for(let t=0;t<e.length;t++)for(let n=0;n<e[t].length;n++){const a=await Ye(e[t][n],t,n);e[t][n]=a}}async function Be(){var u,l;const e=["Homestead","Farm","Village","Town","City"],t=x();for(let c=0;c<q.length;c++){const i=q[c];let s=g(0,t==null?void 0:t.length),d=g(0,(u=t[s])==null?void 0:u.length);const f=await I(i,d,s);for(let m=0;m<6-i;m++){let p=f[0],M=f[1];p=p+m*g(-2,2),M=M+m*g(-2,2);const P=await I(i,M,p);C[y[1]][y[0]].locs.push([P[0],P[1]]),t[P[1]][P[0]].structure={type:e[i-1],imageId:g(0,i-1)+2};for(let K=0;K<g(1,1+i);K++){let T=p+g(-2,2),B=M+g(-2,2);T===p&&(T+=1),B===M&&(B+=1),T=T,B=B;const E=await I(i,B,T),Y=await W(),j=ne[i-1];let $=j[Math.floor(Math.random()*j.length)];if(Y.age<20&&($=$),Y.age<10&&($="Child"),Y.age<4&&($="Infant"),t[E[1]][E[0]].person={data:Y,imageId:Y.imageId,profession:$},i===1||i===2&&Math.random()>.3){const D=g(0,6),le=g(-1,1),ce=g(-1,1),z=(l=t[E[1]+le])==null?void 0:l[E[0]+ce];z&&(z.animal={id:D,imageId:26+D,story:Me[D]})}}}}for(let c=0;c<20;c++){let i=g(0,199),s=g(0,199);if(Math.random()>.3){const d=await I(6,s,i),f=g(0,5);t[d[1]][d[0]].animal={id:f,imageId:33+f,story:Ie[f]}}else{const d=await I(7,s,i),f=await W(),m=k[Math.floor(Math.random()*k.length)];t[d[1]][d[0]].person={data:f,imageId:f.imageId,profession:m,isWander:!0}}}for(let c=0;c<g(2,4);c++){let i=g(0,199),s=g(0,199);const d=await I(7,s,i),f=g(0,17);t[d[1]][d[0]].special={id:f,imageId:39+f,story:ge[f]}}let n=g(101,102),a=g(101,102);const r=await I(1,a,n),o=await W();t[r[1]][r[0]].person={data:o,imageId:o.imageId,profession:"Peddler",isWander:!0}}async function I(e,t,n){let a=e===4||e===5?["plains"]:["forest","plains"];return e===6&&(a=["forest","plains","mountain","water"]),e===7&&(a=["forest","plains","mountain","snow"]),await O(n,t,a)}function Ye(e,t,n){return new Promise(a=>{const r=se(e),o=$e(r,e,oe[t][n]);a({elevation:e,color:Ce[r],biome:r,tree:o,person:void 0,structure:void 0,animal:void 0,special:void 0})})}function $e(e,t,n){let a;if(n>18){let r=!1;return(t===19&&Math.random()>.98||e==="forest"&&Math.random()>.4||e==="plains"&&Math.random()>.85||e==="mountain"&&Math.random()>.85||e==="snow"&&Math.random()>.98)&&(r=!0),r&&(a={imageId:t>100?1:2}),a}}let ee=!1;function G(){var l,c;const e=document.querySelectorAll(".tile"),n=x()[h[1]][h[0]];let a="";S.innerHTML="",ee||(a+="You set out on your journey to apprentice your way to the top! Start by finding a Peddler to apprentice under then a hunter, and so on.",ee=!0),n.structure&&(a+=`You approach a ${n.structure.type}. `),n.animal&&(a+=`${n.animal.story}. `),n.special&&(a+=`${n.special.story} `);let r;if(n.person){let i;if(n.person.isWander?i="Walking out along a small path":i="As you approach a settlment",a+=`${i}, you meet a ${n.person.profession} named ${n.person.data.name}. `,k[w-1]&&((l=n.person)==null?void 0:l.profession)===k[w-1]&&(a+=`You apprentice under ${n.person.data.name}. `),n.person.isWander){Math.random()>.7&&(a+=`They tell you of the largest city in the area. They say it's located in the fiefdom of ${R[H[1]+H[0]]}. `),a+=`The ${n.person.profession} shares the location of a settlment in this fiefdom: `;const s=(c=C[y[1]])==null?void 0:c[y[0]].locs;a+=`${s[Math.floor(Math.random()*s.length)].join("-")}`}r=ae(n.person.data,n.person.profession,v)}if(a===""&&(a+=`Location ${R[y[1]+y[0]]} fiefdom ${h.join("-")}. `),S.textContent=a,r&&S.append(r),e.length>0)for(let i=0;i<e.length;i++)e[i].remove();const o=h[0]-3,u=h[1]-3;for(let i=0;i<14;i++){let s=0;if(i<=6)for(;i-s>-1;){const d=[350-50*i+s*100,25*i-s],f=[i-s+o,s+u];te([`M ${d[0]} ${d[1]} l 50 25 l -50 25 l -50 -25 Z`,`M ${d[0]-50} ${d[1]+25} l 50 25 l 0 45 l -50 -25 Z`,`M ${d[0]} ${d[1]+50} l 50 -25 l 0 45 l -50 25 Z`],f[0]+"-"+f[1],"stone",d,f),s++}else for(;s+(i-6)<7;){const d=[50+50*(s+(i-6))+s*50,25*i-s],f=[6-s+o,s+(i-6)+u];te([`M ${d[0]} ${d[1]} l 50 25 l -50 25 l -50 -25 Z`,`M ${d[0]-50} ${d[1]+25} l 50 25 l 0 45 l -50 -25 Z`,`M ${d[0]} ${d[1]+50} l 50 -25 l 0 45 l -50 25 Z`],f[0]+"-"+f[1],"stone",d,f),s++}}}function te(e,t,n,a,r){var d;const o=x();let u=i("g");if(!((d=o[r[1]])!=null&&d[r[0]]))return;const l=o[r[1]][r[0]];for(let f=0;f<e.length;f++){let m=i("path",e[f]);m.setAttribute("fill",l.color),f>0&&m.setAttribute("opacity",.7),u.appendChild(m)}u.classList.add("tile"),u.dataset.xyid=t;let c=o[h[1]][h[0]].elevation-l.elevation;l.biome==="water"&&(c=c*.5),l.biome==="mountain"&&(c=c*2),l.biome==="snow"&&(c=c*2.5),u.setAttribute("transform",`translate(0, ${c})`),u.setAttribute("opacity",1-c*.015),X.appendChild(u),l.tree&&s(v[l.tree.imageId]),l.structure&&s(v[l.structure.imageId]),l.animal&&s(v[l.animal.imageId]),l.person&&s(v[l.person.imageId]),l.special&&s(v[l.special.imageId]),t===h.join("-")&&s(v[0],"player");function i(f,m){let p=document.createElementNS("http://www.w3.org/2000/svg",f);return m&&f==="path"&&p.setAttribute("d",m),p}function s(f,m){const p=i("image");p.setAttribute("href",f),p.setAttribute("width",100),p.setAttribute("height",100),p.classList.add("tile"),m&&p.classList.add(m),p.setAttribute("x",a[0]-50),p.setAttribute("y",a[1]-70),p.setAttribute("transform",`translate(0, ${c})`),p.setAttribute("opacity",1-c*.01),X.appendChild(p)}}function Re(e){const t=[];for(let n=0;n<e;n++){const a=document.createElement("img");a.src=v[44],a.style.top=g(10,20)+"%",a.style.left=g(10,90)+"%",a.classList.add("stars"),t.push(a),document.body.appendChild(a)}setTimeout(()=>{for(let n=0;n<t.length;n++)t[n].remove()},3e3)}async function Pe(){for(let e=0;e<Q.length;e++){const t=await he([Q[e]]);v.push(t)}}
